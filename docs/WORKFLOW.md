# ê°œë°œ ì›Œí¬í”Œë¡œìš° (Development Workflow)

Heart Stamp Diaryì˜ ë¸Œëœì¹˜ ì „ëµ, ë°°í¬ í”„ë¡œì„¸ìŠ¤, ë²„ì „ ê´€ë¦¬ ë°©ë²•ì„ ì„¤ëª…í•©ë‹ˆë‹¤.

## ğŸ“‹ ëª©ì°¨

1. [ë¸Œëœì¹˜ ì „ëµ](#ë¸Œëœì¹˜-ì „ëµ)
2. [ê°œë°œ ì›Œí¬í”Œë¡œìš°](#ê°œë°œ-ì›Œí¬í”Œë¡œìš°)
3. [ë°°í¬ í”„ë¡œì„¸ìŠ¤](#ë°°í¬-í”„ë¡œì„¸ìŠ¤)
4. [ë²„ì „ ê´€ë¦¬](#ë²„ì „-ê´€ë¦¬)
5. [Git ì»¤ë°‹ ì»¨ë²¤ì…˜](#git-ì»¤ë°‹-ì»¨ë²¤ì…˜)

---

## ğŸŒ³ ë¸Œëœì¹˜ ì „ëµ

### ë¸Œëœì¹˜ êµ¬ì¡°

```
main (í”„ë¡œë•ì…˜)
 â”œâ”€ v1.0.0 - chore: ì²« í”„ë¡œë•ì…˜ ë°°í¬
 â”œâ”€ v1.0.1 - fix: í‘¸ì‹œ ì•Œë¦¼ ë²„ê·¸ ìˆ˜ì •
 â”œâ”€ v1.1.0 - feat: ê°ì • ë¦¬í¬íŠ¸ ì°¨íŠ¸ ì¶”ê°€
 â””â”€ v1.2.0 - feat: ìŠ¤íƒ¬í”„ ì»¬ë ‰ì…˜ ê°œì„ 

dev (ê°œë°œ)
 â”œâ”€ feat: ìƒˆ ê¸°ëŠ¥ ì‘ì—… ì¤‘
 â”œâ”€ fix: ë²„ê·¸ ìˆ˜ì •
 â”œâ”€ refactor: ì½”ë“œ ë¦¬íŒ©í† ë§
 â””â”€ (PR ìƒì„± â†’ Squash merge â†’ main)
```

### ë¸Œëœì¹˜ ì„¤ëª…

| ë¸Œëœì¹˜ | ìš©ë„ | ë³´í˜¸ | ë°°í¬ |
|--------|------|------|------|
| **main** | í”„ë¡œë•ì…˜ ë¦´ë¦¬ì¦ˆ | ğŸ”’ Protected | Production |
| **dev** | ê°œë°œ & í…ŒìŠ¤íŠ¸ | âœ… ììœ ë¡­ê²Œ ì‘ì—… | Development |

### Branch Protection Rules

**main ë¸Œëœì¹˜**:
- âœ… PR í•„ìˆ˜ (ì§ì ‘ push ë¶ˆê°€)
- âœ… Squash merge only
- âœ… Adminë„ bypass ë¶ˆê°€
- âŒ Force push ê¸ˆì§€
- âŒ ì‚­ì œ ê¸ˆì§€

**dev ë¸Œëœì¹˜**:
- âœ… ììœ ë¡­ê²Œ ì»¤ë°‹ & push
- âœ… ì—¬ëŸ¬ ì‘ì—…ì„ ì‘ì€ ì»¤ë°‹ìœ¼ë¡œ ê´€ë¦¬
- âœ… í…ŒìŠ¤íŠ¸ & ì‹¤í—˜ ê°€ëŠ¥

---

## ğŸ”„ ê°œë°œ ì›Œí¬í”Œë¡œìš°

### 1. ìƒˆ ì‘ì—… ì‹œì‘

```bash
# dev ë¸Œëœì¹˜ë¡œ ì „í™˜
git checkout dev

# ìµœì‹  ìƒíƒœë¡œ ì—…ë°ì´íŠ¸
git pull origin dev

# (ì„ íƒì‚¬í•­) feature ë¸Œëœì¹˜ ìƒì„±
git checkout -b feature/new-feature
```

### 2. ê°œë°œ & ì»¤ë°‹

```bash
# ì‘ì—…...
git add .
git commit -m "feat: ìƒˆ ê¸°ëŠ¥ ì¶”ê°€"

# ë” ì‘ì—…...
git add .
git commit -m "fix: ë²„ê·¸ ìˆ˜ì •"

# ê³„ì† ì‘ì—…...
git add .
git commit -m "refactor: ì½”ë“œ ì •ë¦¬"
```

**ì»¤ë°‹ ë©”ì‹œì§€ëŠ” ììœ ë¡­ê²Œ**:
- devì—ì„œëŠ” ì‘ì€ ë‹¨ìœ„ë¡œ ìì£¼ ì»¤ë°‹
- ìƒì„¸í•œ ì„¤ëª…ë³´ë‹¤ëŠ” ì‘ì—… ë‚´ìš© ê°„ë‹¨íˆ ê¸°ë¡
- ë‚˜ì¤‘ì— PRì—ì„œ í•˜ë‚˜ë¡œ í•©ì³ì§ (Squash merge)

### 3. í…ŒìŠ¤íŠ¸

```bash
# ë¡œì»¬ ê°œë°œ ì„œë²„ë¡œ í…ŒìŠ¤íŠ¸
npx expo start

# Development buildë¡œ ì‹¤ì œ ê¸°ê¸° í…ŒìŠ¤íŠ¸
eas build --profile development --platform ios
```

### 4. dev ë¸Œëœì¹˜ì— í‘¸ì‹œ

```bash
# devì— í‘¸ì‹œ
git push origin dev

# (feature ë¸Œëœì¹˜ ì‚¬ìš© ì‹œ)
git checkout dev
git merge feature/new-feature
git push origin dev
```

---

## ğŸš€ ë°°í¬ í”„ë¡œì„¸ìŠ¤

### Phase 1: Development Build í…ŒìŠ¤íŠ¸

```bash
# 1. dev ë¸Œëœì¹˜ì—ì„œ ì‘ì—… ì™„ë£Œ
git checkout dev
git push origin dev

# 2. Development build ìƒì„±
eas build --profile development --platform ios

# 3. ì‹¤ì œ ê¸°ê¸°ì—ì„œ ì¶©ë¶„íˆ í…ŒìŠ¤íŠ¸
# - ê¸°ëŠ¥ ë™ì‘ í™•ì¸
# - ë²„ê·¸ ì—†ëŠ”ì§€ í™•ì¸
# - UX ê²€ì¦
```

**ì—°ê²°ë˜ëŠ” ë°±ì—”ë“œ**: Railway Dev (`heart-stamp-dev.up.railway.app`)

### Phase 2: PR ìƒì„± & ë¦¬ë·°

```bash
# 1. GitHubì—ì„œ Pull Request ìƒì„±
#    Base: main â† Compare: dev
#
# 2. PR ì œëª© (ì¤‘ìš”! ì´ê²Œ mainì˜ ì»¤ë°‹ ë©”ì‹œì§€ê°€ ë¨)
#    v{version} - {type}: {description}
#    ì˜ˆ: v1.1.0 - feat: ê°ì • ë¦¬í¬íŠ¸ ì°¨íŠ¸ ê¸°ëŠ¥ ì¶”ê°€
#
# 3. PR ì„¤ëª…
#    - ë³€ê²½ì‚¬í•­ ìš”ì•½
#    - ìŠ¤í¬ë¦°ìƒ· (UI ë³€ê²½ ì‹œ)
#    - í…ŒìŠ¤íŠ¸ ì™„ë£Œ ì‚¬í•­
```

**PR í…œí”Œë¦¿ ì˜ˆì‹œ**:
```markdown
## ë³€ê²½ì‚¬í•­
- ì£¼ê°„/ì›”ê°„ ê°ì • í†µê³„ ì°¨íŠ¸ ì¶”ê°€
- ì°¨íŠ¸ ë¼ì´ë¸ŒëŸ¬ë¦¬ í†µí•© (react-native-chart-kit)
- ë°˜ì‘í˜• ë””ìì¸ ì ìš©

## í…ŒìŠ¤íŠ¸
- [x] Development build í…ŒìŠ¤íŠ¸ ì™„ë£Œ
- [x] iOS ì‹¤ì œ ê¸°ê¸° í™•ì¸
- [x] ë‹¤ì–‘í•œ ë°ì´í„° ì¼€ì´ìŠ¤ ê²€ì¦

## ìŠ¤í¬ë¦°ìƒ·
[ì´ë¯¸ì§€ ì²¨ë¶€]
```

### Phase 3: Squash Merge

```bash
# GitHub PR í˜ì´ì§€ì—ì„œ
# "Squash and merge" ë²„íŠ¼ í´ë¦­

# Squash commit message í™•ì¸/ìˆ˜ì •:
v1.1.0 - feat: ê°ì • ë¦¬í¬íŠ¸ ì°¨íŠ¸ ê¸°ëŠ¥ ì¶”ê°€

- ì£¼ê°„/ì›”ê°„ ê°ì • í†µê³„ ì°¨íŠ¸ ì¶”ê°€
- ì°¨íŠ¸ ë¼ì´ë¸ŒëŸ¬ë¦¬ í†µí•©
- ë°˜ì‘í˜• ë””ìì¸ ì ìš©
```

**ê²°ê³¼**: devì˜ 10ê°œ ì»¤ë°‹ â†’ mainì˜ 1ê°œ ê¹”ë”í•œ ì»¤ë°‹

### Phase 4: ë²„ì „ íƒœê·¸ & Production Build

```bash
# 1. ë¡œì»¬ main ë¸Œëœì¹˜ ë™ê¸°í™”
git checkout main
git pull origin main

# 2. ë²„ì „ íƒœê·¸ ìƒì„±
git tag v1.1.0
git push --tags

# 3. Production build ìƒì„±
eas build --profile production --platform ios

# 4. (ì•±ìŠ¤í† ì–´ ì œì¶œ ì¤€ë¹„ ì™„ë£Œ ì‹œ) Submit
eas submit --platform ios
```

**ì—°ê²°ë˜ëŠ” ë°±ì—”ë“œ**: Railway Production (`heart-stamp-production.up.railway.app`)

---

## ğŸ·ï¸ ë²„ì „ ê´€ë¦¬

### Semantic Versioning

```
MAJOR.MINOR.PATCH
  v1  . 2  . 3

MAJOR: ëŒ€ê·œëª¨ ë³€ê²½ (í˜¸í™˜ì„± ê¹¨ì§)
MINOR: ìƒˆ ê¸°ëŠ¥ ì¶”ê°€ (í•˜ìœ„ í˜¸í™˜)
PATCH: ë²„ê·¸ ìˆ˜ì •
```

### ë²„ì „ ì—…ë°ì´íŠ¸ ê°€ì´ë“œ

#### Patch (1.0.0 â†’ 1.0.1)
```
ë²„ê·¸ ìˆ˜ì •, ì‘ì€ ê°œì„ 
ì˜ˆ:
- í‘¸ì‹œ ì•Œë¦¼ íƒ€ì´ë° ë²„ê·¸ ìˆ˜ì •
- í…ìŠ¤íŠ¸ ì˜¤íƒ€ ìˆ˜ì •
- ì„±ëŠ¥ ìµœì í™”
```

#### Minor (1.0.0 â†’ 1.1.0)
```
ìƒˆ ê¸°ëŠ¥ ì¶”ê°€ (í•˜ìœ„ í˜¸í™˜)
ì˜ˆ:
- ê°ì • ë¦¬í¬íŠ¸ ì°¨íŠ¸ ì¶”ê°€
- ìŠ¤íƒ¬í”„ ì»¬ë ‰ì…˜ í™”ë©´ ê°œì„ 
- ë‹¤í¬ëª¨ë“œ ì§€ì›
```

#### Major (1.0.0 â†’ 2.0.0)
```
ëŒ€ê·œëª¨ ë³€ê²½, í˜¸í™˜ì„± ê¹¨ì§
ì˜ˆ:
- ì „ì²´ ë””ìì¸ ë¦¬ë‰´ì–¼
- ë°ì´í„° êµ¬ì¡° ë³€ê²½
- ì£¼ìš” ì•„í‚¤í…ì²˜ ê°œí¸
```

### ë²„ì „ ì—…ë°ì´íŠ¸ ì ˆì°¨

**1ë‹¨ê³„: app.json ìˆ˜ì •**
```json
{
  "expo": {
    "version": "1.1.0"  // ìˆ˜ë™ìœ¼ë¡œ ë³€ê²½
  }
}
```

**2ë‹¨ê³„: ì»¤ë°‹ & íƒœê·¸**
```bash
git add app.json
git commit -m "chore: bump version to 1.1.0"
git tag v1.1.0
git push --tags
```

**3ë‹¨ê³„: ë¹Œë“œ**
```bash
eas build --profile production --platform ios
```

---

## ğŸ“ Git ì»¤ë°‹ ì»¨ë²¤ì…˜

### dev ë¸Œëœì¹˜ ì»¤ë°‹ (ììœ ë¡œìš´ í˜•ì‹)

```bash
# ì‘ì€ ë‹¨ìœ„ë¡œ ìì£¼ ì»¤ë°‹
git commit -m "feat: ì°¨íŠ¸ ì»´í¬ë„ŒíŠ¸ ì¶”ê°€"
git commit -m "fix: ë²„ê·¸ ìˆ˜ì •"
git commit -m "style: í¬ë§·íŒ…"
git commit -m "refactor: í•¨ìˆ˜ ë¶„ë¦¬"
```

**íŠ¹ì§•**:
- ì§§ê³  ê°„ë‹¨í•˜ê²Œ
- ì‘ì—… ë‚´ìš©ë§Œ ëª…í™•íˆ
- ë‚˜ì¤‘ì— Squash mergeë¡œ í•©ì³ì§

### PR ì œëª© (main ì»¤ë°‹ ë©”ì‹œì§€ê°€ ë¨)

```
v{version} - {type}: {description}

ì˜ˆì‹œ:
v1.0.1 - fix: í‘¸ì‹œ ì•Œë¦¼ íƒ€ì´ë° ë²„ê·¸ ìˆ˜ì •
v1.1.0 - feat: ê°ì • ë¦¬í¬íŠ¸ ì°¨íŠ¸ ê¸°ëŠ¥ ì¶”ê°€
v1.1.1 - fix: ì°¨íŠ¸ ë Œë”ë§ ì´ìŠˆ ìˆ˜ì •
v1.2.0 - feat: ìŠ¤íƒ¬í”„ ì»¬ë ‰ì…˜ í™”ë©´ ê°œì„ 
v2.0.0 - refactor: ì „ì²´ ì•„í‚¤í…ì²˜ ê°œí¸
```

### Commit Type

| Type | ì„¤ëª… | ë²„ì „ |
|------|------|------|
| **feat** | ìƒˆ ê¸°ëŠ¥ | MINOR â†‘ |
| **fix** | ë²„ê·¸ ìˆ˜ì • | PATCH â†‘ |
| **perf** | ì„±ëŠ¥ ê°œì„  | PATCH â†‘ |
| **refactor** | ë¦¬íŒ©í† ë§ | PATCH â†‘ |
| **style** | ì½”ë“œ ìŠ¤íƒ€ì¼ | PATCH â†‘ |
| **docs** | ë¬¸ì„œ ì—…ë°ì´íŠ¸ | - |
| **chore** | ê¸°íƒ€ ì‘ì—… | - |
| **breaking** | í˜¸í™˜ì„± ê¹¨ì§ | MAJOR â†‘ |

---

## ğŸ¯ í™˜ê²½ë³„ ë¹Œë“œ & ì„œë²„

### ë¹Œë“œ í”„ë¡œíŒŒì¼

| í”„ë¡œíŒŒì¼ | ìš©ë„ | ë°±ì—”ë“œ | ì„¤ì¹˜ ë°©ë²• |
|---------|------|--------|----------|
| **development** | ê°œë°œ & í…ŒìŠ¤íŠ¸ | Railway Dev | ì§ì ‘ ì„¤ì¹˜ |
| **preview** | ë‚´ë¶€ í…ŒìŠ¤íŠ¸ | Railway Dev | ì§ì ‘ ì„¤ì¹˜ |
| **production** | ì•±ìŠ¤í† ì–´ ë°°í¬ | Railway Prod | TestFlight |

### í™˜ê²½ë³„ API ì—”ë“œí¬ì¸íŠ¸

```typescript
// ë¡œì»¬ ê°œë°œ (npx expo start)
__DEV__ = true
â†’ http://192.168.0.14:3000/api

// Development/Preview Build
APP_ENV = "development"
â†’ https://heart-stamp-dev.up.railway.app/api

// Production Build
APP_ENV = "production"
â†’ https://heart-stamp-production.up.railway.app/api
```

---

## ğŸš¨ ìì£¼ í•˜ëŠ” ì‹¤ìˆ˜

### âŒ mainì— ì§ì ‘ push
```bash
git checkout main
git add .
git commit -m "fix: ë²„ê·¸ ìˆ˜ì •"
git push origin main  # âŒ ê±°ë¶€ë¨!
```

**í•´ê²°**: devì—ì„œ ì‘ì—… í›„ PR ìƒì„±

### âŒ ë²„ì „ íƒœê·¸ ê¹œë¹¡í•¨
```bash
# ë°°í¬ëŠ” í–ˆëŠ”ë° íƒœê·¸ë¥¼ ì•ˆ ë‹¬ì•˜ì„ ë•Œ
git tag v1.1.0 HEAD^  # ì´ì „ ì»¤ë°‹ì— íƒœê·¸
git push --tags
```

### âŒ PR ì œëª© ì˜ëª» ì‘ì„±
```bash
# ë‚˜ìœ ì˜ˆ
"ë²„ê·¸ ìˆ˜ì •"  # âŒ ë²„ì „ ì—†ìŒ
"v1.1.0"     # âŒ ì„¤ëª… ì—†ìŒ

# ì¢‹ì€ ì˜ˆ
"v1.1.0 - fix: í‘¸ì‹œ ì•Œë¦¼ íƒ€ì´ë° ë²„ê·¸ ìˆ˜ì •"  # âœ…
```

---

## ğŸ“Š ë¦´ë¦¬ì¦ˆ ì²´í¬ë¦¬ìŠ¤íŠ¸

### Development Build
- [ ] dev ë¸Œëœì¹˜ì— ëª¨ë“  ë³€ê²½ì‚¬í•­ ì»¤ë°‹
- [ ] Development build ìƒì„±
- [ ] ì‹¤ì œ ê¸°ê¸°ì—ì„œ ì¶©ë¶„íˆ í…ŒìŠ¤íŠ¸
- [ ] ë²„ê·¸ ì—†ëŠ”ì§€ í™•ì¸

### Production Build (ì•±ìŠ¤í† ì–´ ì œì¶œ)
- [ ] PR ìƒì„± (dev â†’ main)
- [ ] PR ì œëª© & ì„¤ëª… ì‘ì„±
- [ ] Squash merge ì™„ë£Œ
- [ ] app.json ë²„ì „ ì—…ë°ì´íŠ¸
- [ ] Git tag ìƒì„±
- [ ] Production build ìƒì„±
- [ ] ì•±ìŠ¤í† ì–´ ë©”íƒ€ë°ì´í„° ì¤€ë¹„
- [ ] ìŠ¤í¬ë¦°ìƒ· ì¤€ë¹„
- [ ] eas submit ì‹¤í–‰

---

## ğŸ”— ê´€ë ¨ ë¬¸ì„œ

- [ì¸í”„ë¼ êµ¬ì„±](./INFRASTRUCTURE.md) - ë°°í¬ í™˜ê²½
- [ë³´ì•ˆ ì „ëµ](./SECURITY.md) - ë°ì´í„° ë³´í˜¸
- [AI í†µí•©](./AI_INTEGRATION.md) - ë°°ì¹˜ ì‘ì—…

---

**ë§ˆì§€ë§‰ ì—…ë°ì´íŠ¸**: 2025-11-09
**ì‘ì„±ì**: Heart Stamp Diary Team
