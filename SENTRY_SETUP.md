# Sentry ì—ëŸ¬ ì¶”ì  ì„¤ì • ê°€ì´ë“œ

## ğŸ“Š Sentry ì—ëŸ¬ ì¶”ì  ì‹œìŠ¤í…œ êµ¬í˜„ ì™„ë£Œ!

Heart Stamp ì•±ì— **Sentry** ê¸°ë°˜ì˜ ì‹¤ì‹œê°„ ì—ëŸ¬ ì¶”ì  ì‹œìŠ¤í…œì´ êµ¬í˜„ë˜ì—ˆìŠµë‹ˆë‹¤.

### âœ… êµ¬í˜„ëœ í•µì‹¬ ê¸°ëŠ¥

#### 1. **ì—ëŸ¬ ì¶”ì  ì½”ì–´**
- `src/config/sentry.ts`: Sentry ì´ˆê¸°í™” ë° ì„¤ì •
- `ErrorBoundary`: React ì—ëŸ¬ ìë™ ìº¡ì²˜ ë° ì „ì†¡
- `App.tsx`: ì‚¬ìš©ì ID ì—°ê²°

#### 2. **ì¶”ì ë˜ëŠ” ì—ëŸ¬ ìœ í˜•**
| ì—ëŸ¬ ë ˆë²¨ | ì„¤ëª… | ì˜ˆì‹œ |
|----------|------|-----|
| `fatal` | ì•± ì „ì²´ í¬ë˜ì‹œ | ì•± ë ˆë²¨ ErrorBoundaryì—ì„œ ìº¡ì²˜ |
| `error` | í™”ë©´/ì»´í¬ë„ŒíŠ¸ ì—ëŸ¬ | ìŠ¤í¬ë¦°/ì»´í¬ë„ŒíŠ¸ ë ˆë²¨ ErrorBoundary |
| `warning` | ê²½ê³  | ìˆ˜ë™ ìº¡ì²˜ (API ì‹¤íŒ¨ ë“±) |
| `info` | ì •ë³´ì„± ë¡œê·¸ | Breadcrumb |

#### 3. **ìë™ ìˆ˜ì§‘ ì •ë³´**
- ì—ëŸ¬ ìŠ¤íƒ íŠ¸ë ˆì´ìŠ¤
- React ì»´í¬ë„ŒíŠ¸ ìŠ¤íƒ
- ì‚¬ìš©ì ID (UUID, ê°œì¸ì •ë³´ ì—†ìŒ)
- ì•± ë²„ì „, í”Œë«í¼ (iOS/Android)
- ë””ë°”ì´ìŠ¤ ì •ë³´

---

## ğŸš€ Sentry í”„ë¡œì íŠ¸ ì„¤ì • (í•„ìˆ˜!)

### 1ï¸âƒ£ Sentry ê³„ì • ìƒì„±

1. [Sentry.io](https://sentry.io/) íšŒì›ê°€ì…
2. ë¬´ë£Œ í”Œëœìœ¼ë¡œ ì‹œì‘ ê°€ëŠ¥ (ì›” 5,000 ì—ëŸ¬ê¹Œì§€ ë¬´ë£Œ)

### 2ï¸âƒ£ React Native í”„ë¡œì íŠ¸ ìƒì„±

1. Sentry ëŒ€ì‹œë³´ë“œ â†’ **Create Project**
2. í”Œë«í¼ ì„ íƒ: **React Native**
3. í”„ë¡œì íŠ¸ ì´ë¦„: `heart-stamp`
4. Alert ì„¤ì •: ê¸°ë³¸ê°’ ì‚¬ìš©

### 3ï¸âƒ£ DSN ë³µì‚¬

í”„ë¡œì íŠ¸ ìƒì„± í›„ í‘œì‹œë˜ëŠ” **DSN (Data Source Name)**ì„ ë³µì‚¬í•©ë‹ˆë‹¤.

ì˜ˆì‹œ:
```
https://abc123def456@o123456.ingest.sentry.io/7890123
```

### 4ï¸âƒ£ í™˜ê²½ ë³€ìˆ˜ ì„¤ì •

í”„ë¡œì íŠ¸ ë£¨íŠ¸ì— `.env` íŒŒì¼ ìƒì„± ë˜ëŠ” ìˆ˜ì •:

```bash
# Sentry DSN (í”„ë¡œë•ì…˜ìš©)
EXPO_PUBLIC_SENTRY_DSN=https://YOUR_DSN_HERE
```

âš ï¸ **ì¤‘ìš”**: `.env` íŒŒì¼ì€ `.gitignore`ì— ì¶”ê°€ë˜ì–´ ìˆìœ¼ë¯€ë¡œ Gitì— ì»¤ë°‹ë˜ì§€ ì•ŠìŠµë‹ˆë‹¤.

---

## ğŸ§ª í…ŒìŠ¤íŠ¸ ë°©ë²•

### ê°œë°œ ëª¨ë“œì—ì„œ í™•ì¸

**í˜„ì¬ ì„¤ì •**: ê°œë°œ ëª¨ë“œ(`__DEV__ = true`)ì—ì„œëŠ” Sentryê°€ **ë¹„í™œì„±í™”**ë˜ì–´ ìˆìŠµë‹ˆë‹¤.

ê°œë°œ ì¤‘ì—ëŠ” ì½˜ì†” ë¡œê·¸ë§Œ ì¶œë ¥ë˜ê³  Sentryë¡œ ì „ì†¡ë˜ì§€ ì•ŠìŠµë‹ˆë‹¤:

```
âœ… Sentry disabled in development mode
âŒ [ErrorBoundary] Caught error: ...
```

### í”„ë¡œë•ì…˜ ë¹Œë“œì—ì„œ í…ŒìŠ¤íŠ¸

1. **í”„ë¡œë•ì…˜ ë¹Œë“œ ìƒì„±**:
   ```bash
   eas build --profile production --platform ios
   ```

2. **TestFlight/App Store Connect**ì—ì„œ ë¹Œë“œ ë‹¤ìš´ë¡œë“œ

3. **ì˜ë„ì ìœ¼ë¡œ ì—ëŸ¬ ë°œìƒì‹œí‚¤ê¸°**:
   - ì•±ì—ì„œ ì¡´ì¬í•˜ì§€ ì•ŠëŠ” ì¼ê¸° IDë¡œ ì ‘ê·¼
   - ì˜ëª»ëœ ë°ì´í„° ì…ë ¥
   - ë„¤íŠ¸ì›Œí¬ ì˜¤í”„ë¼ì¸ ìƒíƒœì—ì„œ ë™ê¸°í™”

4. **Sentry ëŒ€ì‹œë³´ë“œ** í™•ì¸:
   - [sentry.io](https://sentry.io) â†’ í”„ë¡œì íŠ¸ â†’ **Issues**
   - ì‹¤ì‹œê°„ìœ¼ë¡œ ì—ëŸ¬ í‘œì‹œ

---

## ğŸ“Š Sentry ëŒ€ì‹œë³´ë“œ í™œìš©

### 1. Issues (ì—ëŸ¬ ëª©ë¡)

**ìë™ ê·¸ë£¹í™”**: ê°™ì€ ì—ëŸ¬ëŠ” ìë™ìœ¼ë¡œ ê·¸ë£¹í™”ë©ë‹ˆë‹¤.

ì˜ˆì‹œ:
```
TypeError: Cannot read property 'date' of undefined
- ë°œìƒ íšŸìˆ˜: 12íšŒ
- ì˜í–¥ë°›ì€ ì‚¬ìš©ì: 3ëª…
- ìµœì´ˆ ë°œê²¬: 2025-01-08
- ìµœê·¼ ë°œê²¬: 2025-01-09
```

### 2. ì—ëŸ¬ ìƒì„¸ ì •ë³´

í´ë¦­í•˜ë©´ ë‹¤ìŒ ì •ë³´ í™•ì¸ ê°€ëŠ¥:
- **ìŠ¤íƒ íŠ¸ë ˆì´ìŠ¤**: ì—ëŸ¬ê°€ ë°œìƒí•œ ì •í™•í•œ ìœ„ì¹˜
- **Breadcrumbs**: ì—ëŸ¬ ë°œìƒ ì „ ì‚¬ìš©ì í–‰ë™
- **ë””ë°”ì´ìŠ¤**: iOS 16.0, iPhone 13 Pro ë“±
- **ì‚¬ìš©ì ID**: UUID (ë””ë²„ê¹…ìš©)

### 3. Alerts (ì•Œë¦¼ ì„¤ì •)

**ìë™ ì•Œë¦¼**:
- Slack ì—°ë™
- ì´ë©”ì¼ ì•Œë¦¼
- ìƒˆë¡œìš´ ì—ëŸ¬ ë°œìƒ ì‹œ ì¦‰ì‹œ ì•Œë¦¼

---

## ğŸ¯ í™œìš© ì‚¬ë¡€

### 1. í”„ë¡œë•ì…˜ ì—ëŸ¬ ì¦‰ì‹œ ê°ì§€

```
[Sentry Alert] ğŸš¨ ìƒˆë¡œìš´ ì—ëŸ¬ ë°œìƒ
- DiaryDetailScreen: Cannot read property 'aiComment' of null
- ì˜í–¥ë°›ì€ ì‚¬ìš©ì: 5ëª…
- ìœ„ì¹˜: DiaryDetailScreen.tsx:142
```

â†’ ì‚¬ìš©ìê°€ ë¦¬í¬íŠ¸í•˜ê¸° ì „ì— ë¨¼ì € ë°œê²¬í•˜ê³  ìˆ˜ì •!

### 2. íŠ¹ì • ë²„ì „ì˜ ë²„ê·¸ ì¶”ì 

**Releases ê¸°ëŠ¥**:
```typescript
// sentry.tsì—ì„œ ì„¤ì •ë¨
release: 'heart-stamp@1.0.0',
```

ë²„ì „ë³„ ì—ëŸ¬ ë¹„êµ:
- v1.0.0: `TypeError` 12íšŒ
- v1.0.1: `TypeError` 0íšŒ (ìˆ˜ì •ë¨!)

### 3. ì‚¬ìš©ìë³„ ì—ëŸ¬ íŒ¨í„´ ë¶„ì„

**ì‚¬ìš©ì IDë¡œ í•„í„°ë§**:
```
User: abc-123-def
- ì´ ì—ëŸ¬: 3íšŒ
- ìµœê·¼ ì—ëŸ¬: "Network request failed"
- ë””ë°”ì´ìŠ¤: iPhone 12, iOS 15.0
```

â†’ íŠ¹ì • ë””ë°”ì´ìŠ¤/OS ë²„ì „ ë¬¸ì œ ë°œê²¬ ê°€ëŠ¥

---

## ğŸ”’ ê°œì¸ì •ë³´ ë³´í˜¸

### ì´ë¯¸ ì¤€ë¹„ëœ ê²ƒ âœ…

**ìë™ í•„í„°ë§** (`src/config/sentry.ts:32-47`):
```typescript
beforeSend(event, hint) {
  // ë¯¼ê°í•œ ì •ë³´ ìë™ ì œê±°
  if (event.request) {
    delete event.request.cookies;
    delete event.request.headers;
  }

  // ì‚¬ìš©ì ì •ë³´ì—ì„œ PII ì œê±°
  if (event.user) {
    delete event.user.email;
    delete event.user.username;
    // UUIDë§Œ ìœ ì§€ (ë””ë²„ê¹…ìš©)
  }

  return event;
}
```

### ì „ì†¡ë˜ëŠ” ì •ë³´
- âœ… ì—ëŸ¬ ìŠ¤íƒ íŠ¸ë ˆì´ìŠ¤
- âœ… ì‚¬ìš©ì ID (UUID, ìµëª…)
- âœ… ë””ë°”ì´ìŠ¤/OS ì •ë³´
- âŒ ì¼ê¸° ë‚´ìš©
- âŒ ì´ë©”ì¼, ì´ë¦„ ë“± PII

---

## ğŸ’¡ Best Practices

### 1. ìˆ˜ë™ ì—ëŸ¬ ìº¡ì²˜

API ì‹¤íŒ¨ ë“± ì˜ˆìƒ ê°€ëŠ¥í•œ ì—ëŸ¬ë„ ìˆ˜ë™ìœ¼ë¡œ ì „ì†¡ ê°€ëŠ¥:

```typescript
import { captureException } from '../config/sentry';

try {
  await apiService.uploadDiary(diary);
} catch (error) {
  // Sentryì— ì»¨í…ìŠ¤íŠ¸ì™€ í•¨ê»˜ ì „ì†¡
  captureException(error as Error, {
    diaryId: diary._id,
    operation: 'uploadDiary',
  });

  // ì‚¬ìš©ìì—ê²Œ ì•Œë¦¼
  Alert.alert('ì—…ë¡œë“œ ì‹¤íŒ¨', 'ë‹¤ì‹œ ì‹œë„í•´ì£¼ì„¸ìš”');
}
```

### 2. Breadcrumbs í™œìš©

ì‚¬ìš©ì í–‰ë™ ì¶”ì :

```typescript
import { addBreadcrumb } from '../config/sentry';

const handleDiarySave = async () => {
  addBreadcrumb('Saving diary', {
    characterCount: content.length,
    hasMood: !!selectedMood,
  });

  await DiaryStorage.create({ ... });
};
```

### 3. ì„±ëŠ¥ ëª¨ë‹ˆí„°ë§

ëŠë¦° ì‘ì—… ì¶”ì :

```typescript
import { startTransaction } from '../config/sentry';

const transaction = startTransaction('diary_sync', 'task');
await syncDiaries();
transaction?.finish();
```

---

## â“ FAQ

### Q1. ë¹„ìš©ì´ ì–¼ë§ˆë‚˜ ë‚˜ì˜¤ë‚˜ìš”?

**A**: Sentry ë¬´ë£Œ í”Œëœ:
- ì›” 5,000 ì—ëŸ¬ê¹Œì§€ ë¬´ë£Œ
- 90ì¼ ë°ì´í„° ë³´ê´€
- ë¬´ì œí•œ í”„ë¡œì íŠ¸

ìœ ë£Œ í”Œëœ: $26/ì›”ë¶€í„° (ì›” 50,000 ì—ëŸ¬)

### Q2. ê°œë°œ ì¤‘ì—ë„ Sentryë¡œ ì „ì†¡ë˜ë‚˜ìš”?

**A**: ì•„ë‹ˆìš”! `src/config/sentry.ts:17`ì—ì„œ í™•ì¸:
```typescript
const SENTRY_ENABLED = !__DEV__;
```

ê°œë°œ ëª¨ë“œ(`__DEV__ = true`)ì—ì„œëŠ”:
- Sentry ì „ì†¡ ì•ˆ í•¨
- ì½˜ì†” ë¡œê·¸ë§Œ ì¶œë ¥

### Q3. Firebase Analyticsì™€ ì°¨ì´ì ì€?

**A**:
| ê¸°ëŠ¥ | Firebase Analytics | Sentry |
|------|-------------------|--------|
| **ëª©ì ** | ì‚¬ìš©ì í–‰ë™ ë¶„ì„ | ì—ëŸ¬ ì¶”ì  |
| **ìˆ˜ì§‘ ë°ì´í„°** | ì´ë²¤íŠ¸, ë¦¬í…ì…˜ | ì—ëŸ¬, í¬ë˜ì‹œ |
| **ì•Œë¦¼** | âŒ | âœ… ì‹¤ì‹œê°„ ì•Œë¦¼ |
| **ìŠ¤íƒ íŠ¸ë ˆì´ìŠ¤** | âŒ | âœ… ìë™ ìˆ˜ì§‘ |

â†’ ë‘ ì„œë¹„ìŠ¤ ëª¨ë‘ ì‚¬ìš© ê¶Œì¥! (ìƒí˜¸ ë³´ì™„ì )

### Q4. ì—ëŸ¬ê°€ ë„ˆë¬´ ë§ì´ ë°œìƒí•˜ë©´?

**A**: Sentry í•„í„°ë§ ê¸°ëŠ¥:
1. **Ignore Errors**: íŠ¹ì • ì—ëŸ¬ ë¬´ì‹œ
   ```typescript
   ignoreErrors: [
     'Network request failed',  // ì„ì‹œ ë„¤íŠ¸ì›Œí¬ ì˜¤ë¥˜ ë¬´ì‹œ
   ]
   ```

2. **Sample Rate**: ìƒ˜í”Œë§ ë¹„ìœ¨ ì¡°ì •
   ```typescript
   tracesSampleRate: 0.1,  // 10%ë§Œ ìˆ˜ì§‘
   ```

---

## ğŸš€ ì¤€ë¹„ ì™„ë£Œ!

Sentry ì—ëŸ¬ ì¶”ì  ì‹œìŠ¤í…œì´ ì™„ë²½í•˜ê²Œ ì¤€ë¹„ë˜ì—ˆìŠµë‹ˆë‹¤!

**ì´ì œ í•´ì•¼ í•  ì¼**:
1. âœ… Sentry ê³„ì • ìƒì„±
2. âœ… React Native í”„ë¡œì íŠ¸ ìƒì„±
3. âœ… DSN ë³µì‚¬ ë° í™˜ê²½ ë³€ìˆ˜ ì„¤ì •
4. âœ… í”„ë¡œë•ì…˜ ë¹Œë“œ í…ŒìŠ¤íŠ¸
5. âœ… Sentry ëŒ€ì‹œë³´ë“œì—ì„œ ì—ëŸ¬ í™•ì¸

**ë‹¤ìŒ ì‘ì—…**:
- Slack ì•Œë¦¼ ì—°ë™
- Release Tracking ì„¤ì •
- ì„±ëŠ¥ ëª¨ë‹ˆí„°ë§ í™œì„±í™”

---

**ë¬¸ì˜ì‚¬í•­ì´ ìˆìœ¼ë©´ ì–¸ì œë“ ì§€ ë§ì”€í•´ì£¼ì„¸ìš”!** ğŸ™Œ
